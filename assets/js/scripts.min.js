"use strict";
/*! Author: Dark Preacher */var notyf=new Notyf({duration:5e3,dismissible:!0,ripple:!0,position:{x:"right",y:"top"},types:[{type:"warning",duration:2e3,background:"orange",icon:!1}]});function news(){return{markRead:function(t,e){this.countNews-=1,t.classList.remove("news-item--new"),$.post("action.php",{action:"markNews",id:e})}}}function add(){return{type:"theme",theme:{},series:{},user:{},init:function(){this.reInit()},reInit:function(){this.theme={name:null,url:null,path:null,update_header:1},this.series={tracker:"",name:null,path:null,hd:0},this.user={tracker:"",name:null}},addTheme:function(t,e){this.theme.action=t,$.post(e.action,this.theme,function(t){t.error?notyf.error(t.msg):(notyf.success(t.msg),this.showPage("show_table"),this.closeModalAdd(),this.reInit())}.bind(this),"json")},addSeries:function(t,e){this.series.action=t,$.post(e.action,this.series,function(t){t.error?notyf.error(t.msg):(notyf.success(t.msg),this.showPage("show_table"),this.closeModalAdd(),this.reInit())}.bind(this),"json")},addUser:function(t,e){this.user.action=t,$.post(e.action,this.user,function(t){t.error?notyf.error(t.msg):(notyf.success(t.msg),this.showPage("show_watching"),this.closeModalAdd(),this.reInit())}.bind(this),"json")}}}function warnings(){return{cleared:!1,showAll:!1,clear:function(t,e){notyf.open({type:"warning",message:"Обрабатывается запрос…"}),$.post("action.php",{action:"clear_warnings",tracker:t},function(t){var n=this;t.error?notyf.error(t.msg):setTimeout((function(){n.cleared=!0,n.countErrors-=e,notyf.success(t.msg)}),1e3)}.bind(this),"json")}}}function item(){return{deleted:!1,showInfo:!1,showDelete:!1,deleteItem:function(t){notyf.open({type:"warning",message:"Обрабатывается запрос…"}),$.post("action.php",{action:"del",id:t},function(t){var e=this;t.error?notyf.error(t.msg):setTimeout((function(){e.deleted=!0,notyf.success(t.msg)}),1e3)}.bind(this),"json")}}}function userItem(){return{deleted:!1,showDownload:!1,showMonitor:!1,showDelete:!1,downloadItem:function(t,e){notyf.open({type:"warning",message:"Обрабатывается запрос…"}),$.post("action.php",{action:"threme_add",id:t,user_id:e},function(t){var e=this;t.error?notyf.error("Ошибка передачи данных<br>Попробуйте ещё раз."):setTimeout((function(){e.deleted=!0,notyf.success(t.msg)}),1e3)}.bind(this),"json")},monitorItem:function(t){notyf.open({type:"warning",message:"Обрабатывается запрос…"}),$.post("action.php",{action:"transfer_from_buffer",id:t},function(t){var e=this;t.error?notyf.error(t.msg):setTimeout((function(){e.deleted=!0,notyf.success(t.msg)}),1e3)}.bind(this),"json")},deleteItem:function(t){notyf.open({type:"warning",message:"Обрабатывается запрос…"}),$.post("action.php",{action:"delete_from_buffer",id:t},function(t){var e=this;t.error?notyf.error(t.msg):setTimeout((function(){e.deleted=!0,notyf.success(t.msg)}),1e3)}.bind(this),"json")}}}function filterThemes(){return{filterValue:"",go:function(){var t=this.filterValue.toUpperCase(),e=document.getElementById("filterable").getElementsByClassName("tm-item");if(""!==this.filterValue)for(var n=0;n<e.length;n++){e[n].getElementsByClassName("tm-item__title")[0].innerHTML.toUpperCase().indexOf(t)>-1?e[n].style.display="":e[n].style.display="none"}else for(var s=0;s<e.length;s++)e[s].style.display=""}}}function users(t){return{currentUser:-1,showWatched:!1,showDelete:!1,userThemes:null,usersList:t,setUser:function(t){this.currentUser=t,this.showThemes(this.currentUser)},markWatched:function(t){this.showWatched=!1,$.post("action.php",{action:"thremes_clear",user_id:t},function(t){var e=this;t.error?notyf.error(t.msg):(this.setUser(-1),setTimeout((function(){e.showPage("show_watching"),notyf.success(t.msg)}),1e3))}.bind(this),"json")},deleteUser:function(t){this.showDelete=!1,$.post("action.php",{action:"delete_user",user_id:t},function(t){var e=this;t.error?notyf.error(t.msg):(this.setUser(-1),setTimeout((function(){e.showPage("show_watching"),notyf.success(t.msg)}),1e3))}.bind(this),"json")},showThemes:function(t){var e=this;this.pageLoading=!0,fetch("include/show_watching_themes.php?id=".concat(t)).then((function(t){return t.text()})).then((function(t){e.userThemes=t,window.scrollTo(0,0),e.pageLoading=!1}))}}}function credentials(t){return{trackerIndex:"",tracker:"",trackers:t,setTracker:function(){this.tracker=t[this.trackerIndex],this.tracker.action="update_credentials",this.tracker.log=this.tracker.login,this.tracker.pass=this.tracker.password},updateTracker:function(t){$.post(t.action,this.tracker,(function(t){t.error?notyf.error(t.msg):notyf.success(t.msg)}),"json")}}}function settings(t){return{options:t,theme:localStorage.getItem("theme"),currentTab:"basic",password:"",passwordConfirm:"",error:"",setTab:function(t){this.currentTab=t},checkEqualPass:function(){return this.error="",this.password===this.passwordConfirm||(this.error="Пароли не совпадают",!1)},update:function(t,e){this.options.action="update_"+t,$.post(e.action,this.options,(function(t){t.error?notyf.error(t.msg):notyf.success(t.msg)}),"json")},updateAuth:function(t){this.checkEqualPass()&&$.post(t.action,{action:"update_auth",pass:this.password},(function(t){t.error?notyf.error(t.msg):notyf.success(t.msg)}),"json")},setTheme:function(t){localStorage.setItem("theme",t),this.theme=t,document.documentElement.dataset.theme=t}}}function settingsServices(t){return{serviceNotify:0,serviceWarn:0,servicesNotify:t.notify,servicesWarn:t.warn,setServiceNotify:function(){var t=this;this.serviceNotify=this.servicesNotify.find((function(e){return e.id==t.options.sendUpdateService}))},setServiceWarn:function(){var t=this;this.serviceWarn=this.servicesWarn.find((function(e){return e.id==t.options.sendWarningService}))},update:function(t){$.post(t.action,{action:"update_services",notifySend:this.options.sendUpdate,notifyState:this.options.sendUpdateService,notifyService:this.serviceNotify,warnSend:this.options.sendWarning,warnState:this.options.sendWarningService,warnService:this.serviceWarn},(function(t){t.error?notyf.error(t.msg):notyf.success(t.msg)}),"json")}}}document.addEventListener("alpine:init",(function(){Alpine.data("tm",(function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return{pageCurrent:"",pageContents:"",pageLoading:!1,showTopNav:!1,modalAdd:!1,modalEditThemeShow:!1,modalEditSeriesShow:!1,countErrors:t,countNews:e,editData:[],init:function(){this.initTheme(),this.showPage("show_table")},showPage:function(t){var e=this;this.pageLoading=!0,this.pageCurrent=t,fetch("include/".concat(t,".php")).then((function(t){return t.text()})).then((function(t){e.pageContents=t,window.scrollTo(0,0),e.showTopNav=!1,e.pageLoading=!1}))},setSort:function(t,e){this.pageLoading=!0,$.get("action.php",{action:"order",by:t,dir:e},function(t){this.showPage("show_table")}.bind(this),"json")},showModalAdd:function(){this.modalAdd=!0,this.showTopNav=!1,document.body.style.overflowY="hidden"},closeModalAdd:function(){this.modalAdd=!1,document.body.style.overflowY="auto"},modalEditTheme:function(t){this.pageLoading=!0,document.body.style.overflowY="hidden",$.get("action.php",{action:"item_data",id:t},function(t){this.pageLoading=!1,this.editData=t,this.modalEditThemeShow=!0}.bind(this),"json")},closeModalEditTheme:function(){this.modalEditThemeShow=!1,document.body.style.overflowY="auto"},modalEditSeries:function(t){this.pageLoading=!0,document.body.style.overflowY="hidden",$.get("action.php",{action:"item_data",id:t},function(t){this.pageLoading=!1,this.editData=t,this.modalEditSeriesShow=!0}.bind(this),"json")},closeModalEditSeries:function(){this.modalEditSeriesShow=!1,document.body.style.overflowY="auto"},updateItem:function(t,e){this.editData.action="update",this.editData.update=this.editData.auto_update,$.post(t.action,this.editData,function(t){t.error?notyf.error(t.msg):(notyf.success(t.msg),this.showPage("show_table"),this.closeModalEditTheme(),this.closeModalEditSeries())}.bind(this),"json")},initTheme:function(){var t=localStorage.getItem("theme");null!==t&&(document.documentElement.dataset.theme=t)}}}))}));